{
  "title": "GAME_PLAY_MANA returns response_type \"select\" with empty choices array",
  "description": "BridgeCallbackHandler.java:861 unconditionally sets response_type to \"select\" for mana payment prompts. When no mana sources are available (manaChoiceList is empty after filtering), the LLM sees a \"select\" response with zero choices and tries to pick index 0, causing \"Index 0 out of range\" errors and wasted round trips.\n\nThe GAME_SELECT case (line 846) correctly handles this: it checks if choiceList is empty and falls back to response_type \"boolean\". GAME_PLAY_MANA should do the same.\n\nEvidence:\n- ~/mage-bench-logs/game_20260210_224830/Gem2.5 Villain_errors.log: 1 index-out-of-range error at 22:52:16\n- ~/mage-bench-logs/game_20260210_194959/Gem2.5 Villain_errors.log: 5 index-out-of-range + 4 mana parameter errors (19:58-20:30)\n- Reproduces consistently across both games, concentrated on Gemini 2.5 Flash\n\nSource: BridgeCallbackHandler.java:861 â€” response_type set to \"select\" before building choice list, never corrected if list ends up empty\n\nSuggested fix: After building manaChoiceList (line 917), check if empty. If so, set response_type to \"boolean\" and lastChoices to null, matching the GAME_SELECT pattern at lines 846-853.",
  "status": "resolved",
  "priority": 2,
  "type": "bug",
  "labels": ["headless-client"],
  "created_at": "2026-02-10T23:30:00.000000-08:00",
  "updated_at": "2026-02-11T07:53:00.000000-08:00"
}
