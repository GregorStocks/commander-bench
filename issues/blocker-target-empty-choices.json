{
  "title": "GAME_TARGET returns empty choices for blocker-to-attacker assignment",
  "description": "When a player selects a creature to block with (via GAME_SELECT), XMage sends a GAME_TARGET \"Select attacker to block\" for the player to choose which attacker that blocker should block. The `findValidTargets()` method returns null/empty for this message type — `message.getTargets()`, `options.possibleTargets`, and `cardsView1` are all empty despite attackers being present.\n\nThe LLM sees `choices: []` with `required: false, can_cancel: true` and gets trapped: it can't pick an attacker (no choices), so it calls `get_action_choices` repeatedly getting the same empty list. This loop persists until the stall detector or loop detector fires, resulting in all attackers going unblocked.\n\nEvidence:\n- ~/mage-bench-logs/game_20260211_002821/Gem3F Libby_pilot.log: 857 occurrences of \"Select attacker to block\" message (01:08:18 to 01:24:58)\n- 16+ minutes wasted in the loop; Libby took 14 unblocked combat damage (17 -> 3 life)\n\nRoot cause: upstream XMage bug — the server incorrectly computes empty possibleAttackersToBlock when a flying creature is selected as a blocker against ground attackers. See issue xmage-flying-blocker-targets for the server-side bug.\n\nClient-side workaround: auto-cancel non-required GAME_TARGET actions with empty choices in BridgeCallbackHandler.java, both in passPriority() and getActionChoices(). This is safe because required=false means cancellation is always legal, and empty choices means the only valid action is cancellation.",
  "status": "open",
  "priority": 1,
  "type": "bug",
  "labels": ["headless-client", "combat"],
  "created_at": "2026-02-11T07:53:00.000000-08:00",
  "updated_at": "2026-02-11T00:00:00.000000-08:00"
}
