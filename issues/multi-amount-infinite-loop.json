{
  "title": "GAME_GET_MULTI_AMOUNT default action sends invalid answer, causing infinite loop",
  "description": "When loop detection fires during a GAME_GET_MULTI_AMOUNT prompt, executeDefaultAction() sends an answer that the server rejects (assigns min to the first slot, 0 to the rest). The server immediately re-prompts with the same question, the loop detection fires again, and the same bad answer is sent — forever. The game hangs with no progress.\n\nIn game_20260210_170138, Gem2.5Flash's Silverblade Paladin (double strike) was blocked by 2 Zombie tokens during combat. The server asked how to divide combat damage (GAME_GET_MULTI_AMOUNT). After the LLM failed to answer correctly a few times, loop detection kicked in and executeDefaultAction() started sending the default answer. But the default (min for first slot, 0 for rest) didn't satisfy the server's constraint that total damage assigned must equal the creature's power. The server rejected it and re-sent the prompt, creating an infinite loop.\n\nThe loop ran from 18:05:16 until the game was killed at 18:06:52 — 670 GAME_GET_MULTI_AMOUNT occurrences in the pilot log. The game was completely frozen: no other player could act because combat damage assignment was stuck.\n\nEvidence:\n- ~/mage-bench-logs/game_20260210_170138/Gem2.5Flash_pilot.log: 670 GAME_GET_MULTI_AMOUNT entries, loop warnings from 18:05:16 to 18:06:52\n- Sonnet4.5_pilot.log: Sonnet noticed the hang ('The game seems to be timing out'), called pass_priority multiple times with 30s timeouts, none returned\n\nRoot cause: SkeletonCallbackHandler.java:408-417 — executeDefaultAction for GAME_GET_MULTI_AMOUNT assigns multiMin to slot 0 and 0 to the rest. This doesn't satisfy the server's requirement that the amounts sum to the creature's power. The server rejects the answer and re-sends the prompt.\n\nSuggested fix: The default for GAME_GET_MULTI_AMOUNT should distribute the total required amount (max or power) across slots to satisfy the sum constraint. For combat damage, the simplest valid answer is to assign all damage to the first target. Alternatively, assign damage proportionally or evenly. The key requirement is that the sum of amounts equals the required total.",
  "status": "open",
  "priority": 1,
  "type": "bug",
  "labels": ["headless-client"],
  "created_at": "2026-02-10T18:30:00.000000-08:00",
  "updated_at": "2026-02-10T18:30:00.000000-08:00"
}
