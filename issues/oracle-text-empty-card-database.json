{
  "title": "get_oracle_text always fails because headless client has no card sets on classpath",
  "description": "The headless client's get_oracle_text tool always returns \"Card not found in database\" for card name lookups because the local CardRepository is empty.\n\nRoot cause: Mage.Client.Headless/pom.xml depends on `mage` and `mage-common`, but NOT on `mage-sets`. The Sets class discovers expansion set classes via ClassScanner.findClasses(\"mage.sets\", ExpansionSet.class). Without Mage.Sets on the classpath, Sets.getInstance() returns an empty map, so CardScanner.scan() adds zero cards to the H2 database.\n\nThe game itself works fine because the server has Mage.Sets. But the headless client's local card database is empty, so all get_oracle_text lookups by card name fail. This affects every card, old and new â€” even Stoneforge Mystic (2010) and Lightning Bolt fail.\n\nEvidence:\n- game_20260211_190130: Otawara Soaring City, Emperor of Bones not found\n- game_20260211_190135: Stoneforge Mystic, Voice of Victory, Cryptic Coat, Meteor Sword, Pre-War Formalwear, Staff of the Storyteller, Phelia Exuberant Shepherd, Ocelot Pride all not found. Gem3F Sarge wasted dozens of tool calls retrying lookups.\n\nFix: Add mage-sets as a dependency in Mage.Client.Headless/pom.xml:\n\n```xml\n<dependency>\n    <groupId>${project.groupId}</groupId>\n    <artifactId>mage-sets</artifactId>\n    <version>${project.version}</version>\n</dependency>\n```\n\nThis will make the card classes available to ClassScanner so CardScanner.scan() populates the database.",
  "status": "open",
  "priority": 2,
  "type": "task",
  "labels": ["headless-client"],
  "created_at": "2026-02-11T22:00:00.000000-08:00",
  "updated_at": "2026-02-11T22:00:00.000000-08:00"
}
