{
  "title": "Players stop receiving priority callbacks mid-game, causing permanent pass_priority timeouts",
  "description": "In multiplayer games, players can enter a state where `pass_priority` always returns `{timeout: true, action_pending: false}` while the game continues normally for other players. The Java bridge's `pendingAction` stays null because the game server stops delivering callbacks (GAME_SELECT, etc.) to the affected player. Chat messages still flow through, and `get_game_state` shows the game progressing, but no actionable callbacks arrive.\n\nThe existing `retryLastResponseIfLost()` mechanism (designed to handle a race in `HumanPlayer.waitResponseOpen()`) fires but doesn't resolve the desync.\n\nIn game_20260211_002821, this affected TWO players independently:\n- Gem25F Analyst (google/gemini-2.5-flash): desync started ~01:37 during combat damage, persisted for hours. Triggered 13 stall events. Player won only because others died/timed out first.\n- Sonnet Timmy (claude-sonnet-4.5): desync started ~01:56, lasted 28 minutes until timeout elimination. `get_game_state` showed Fellwar Stone on the stack with Sonnet having priority, but `get_action_choices` returned `action_pending: false`.\n\nBoth desyncs started after ~1 hour of gameplay in a 4-player game, possibly triggered by complex combat resolution.\n\nEvidence:\n- ~/mage-bench-logs/game_20260211_002821/Gem25F Analyst_pilot.log: 13 stall events from 00:45 to 06:53, all \"pass_priority timeout + action_pending false\"\n- ~/mage-bench-logs/game_20260211_002821/Sonnet Timmy_pilot.log: 28-minute loop of pass_priority timeouts from 01:56 to 02:24\n- ~/mage-bench-logs/game_20260211_002821/Gem25F Analyst_bridge.jsonl: GAME_SELECT/GAME_UPDATE events stop being delivered while CHATMESSAGE events continue\n\nSource: BridgeCallbackHandler.java:1696 `passPriority()` â€” the method works correctly, but `pendingAction` is never set because the game server never invokes the callback. The root cause is likely a race condition in the XMage server's player priority delivery that `retryLastResponseIfLost()` doesn't fully cover.\n\nSuggested investigation: Compare response tracking (`trackSentResponse`) with incoming callbacks to identify where responses are being lost. The desync may occur when a response is sent but the server's `HumanPlayer.waitResponseOpen()` has already timed out and moved on, leaving the player permanently skipped in the priority rotation.",
  "status": "open",
  "priority": 2,
  "type": "bug",
  "labels": ["headless-client"],
  "created_at": "2026-02-11T07:53:00.000000-08:00",
  "updated_at": "2026-02-11T07:53:00.000000-08:00"
}
